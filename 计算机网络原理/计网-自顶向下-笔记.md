# 计算机网络与因特网
## 1.1 什么是因特网
两种描述:
- 根据具体构成：软件、硬件
- 根据为分布式应用提供的服务
### 1.1.1 具体描述组成
**端系统**，以及链接端系统的**通讯链路和分组交换机**，
### 1.1.2 服务描述
**分布式应用程序（因特网应用有些涉及多个端系统）**，其中端系统提供了**套接字接口**（一套运行了发送程序必须遵守的规则集合）
### 1.1.3 什么是协议
1. 人类活动类比：打招呼，聊天遵守的方式，同样的方式才能聊天
2. **网络协议**：定义了在两个或多个通讯实体间交换的报文的**格式**和**顺序**，以及报文发送和/或接收报文或其他事件所采取的**动作**
## 1.2 网络边缘
上述的总体概述之后，是网络的边缘，之后是网络核心
### 1.2.1 接入网
将端系统接入到边缘路由器的网络
1. 家庭接入：DSL，电缆，FTTH，拨号，卫星
2. 企业（和家庭）接入：以太网、Wifi
3. 广域无线接入：3G和LTE


## 1.4 分组交换中的现实因素（时延，丢包，吞吐量）
### 1.4.1 时延
主要有处理，排队，传输，传播时延
### 1.4.2 丢包（和排队时延）
当流量强度超过1，排队时延就会无限增大。
### 1.4.3 端到端时延
不只是一个路由器上的时延讨论，而是一整个链路
#### 1.4.3.1 其他时延
### 1.4.4 吞吐量
瞬时吞吐量、平均吞吐量。
**木桶效应？**
## 1.5 协议层次及其服务模型
### 1.5.1 协议的体系结构
上层使用下层提供的服务
第n层协议位于网络的不同部件中
除了结构化和概念化的优点，分层有两个潜在缺点：冗余功能、部分可能违反层次分离
本书主要介绍因特网协议栈（而不是ISO OSI七层协议栈）
1. 应用层：
应用层协议分布在端系统上，端系统上的应用程序使用应用层协议交换分组，如HTTP（Web文档）、FTP（文件传输）、SMTP（邮件传输），应用层交换的分组称为**报文**。
2. 运输层：
运输层在应用程序端点之间传送应用层报文
协议如
- TCP：提供面向连接服务（包括确保传递和流量控制），还将长报文划分为短报文，并有拥塞控制机制
- UDP：不提供额外服务
运输层的分组称为报文段
3. 网络层：
网络层将一台主机的网络层报文段带着目的地址传输到另一台主机
- 著名网络协议**IP**：具有网络层的因特网组件必须运行IP
- 还包含一些网络协议和**路由选择协议**，但通常将其称为IP层
**数据报**哟
4. 链路层：
网络层要通过一系列路由器路由数据报，为了移动分组到下一个**节点（主机或路由器）**，必须依赖于链路层的服务
由链路层提供的服务取决于该链路层运行的协议（如提供的不同与TCP的可靠链路服务），如以太网，Wifi，电缆接入网。
一个数据报可能被不同段的链路上的不同协议处理
链路层的分组称为**帧**
5. 物理层：
链路层是将帧从一个网络元素送至临近的其他网络元素，而物理层是将帧中的比特从一个节点移动到下一个节点。
物理层的协议仍然是链路相关的，并进一步与该链路的实际传输媒体有关（如双绞铜线，单模光纤）
例如以太网运行有许多物理层协议：光纤，铜线，同轴电缆等
> OSI模型
> 20世纪70年代后期，国际标准化组织（ISO）提出
> OSI模型的表示层（解释数据含义，进行加密和压缩，或者数据描述）和会话层（数据的定界和同步）在因特网协议中缺失，交由开发者决定应用是否需要两层的功能，并决定实现。

### 1.5.2 封装（Encapsulation）
有效载荷（Field Payload）不断地增加附加信息（或首部信息）形成下一层的分组
Message-Segment-Datagram-Frame
当然，一个大的上层载荷可能会被分为多个小的下层服务分组，在接收端重建
## 1.6 面对攻击的网络
方式：
1. 在主机中植入有害程序
2. 攻击服务器和基础设施
    1. 分布式DoS（DDoS）：无法找到某个发送大量流量的“主犯”，因为DDoS通过僵尸网络
3. 嗅探分组（Packet Sniffer）
4. 伪装信任对象

> 导致这种不安全的境地的根本起源是：互联网是建立在一群相互信任的用户之间的透明的网络

## 1.7 计算机网络和因特网的历史
### 1.7.1 分组交换（1961-1972）
从上世纪60年代占据主导地位的电话网，由于网络中传输的突发性，出现了分组交换
ARPAnet在1969部署四个节点，开发了主机到主机协议，并在1972完成了第一个电子邮电程序
### 1.7.2 专用网络和网络互连（1972-1980）
最初的ARPAnet是一个单一的、封闭的网络。必须与要通讯的主机实际相连。
70年代早期和中期，其余分组交换网络相继问世。
让网络互连的时机到了。
本质上就是创建一个网络的网络。术语：网络互联（internetting）
夏威夷的Abramson在研制ALOHAnet，基于分组的无线电网络，允许多个站点远程通讯。分布用户共享同意广播通讯媒体（频率）
ALOHA协议是第一个多路访问协议。
基于ALOHA协议，研制了用于优先共享广播网络的以太网，此时的以太网是为了连接多台主机、打印机、共享磁盘。

### 1.7.3 网络的激增（1980-1990）
网络数量激增，网络主干速率提升。
1983年，TCP/IP协议替代NCP协议（前面提到的主机到主机协议，是早期TCP和IP的集合体）
80年代，实现基于主机的拥塞控制，研制DNS
### 1.7.4 大 爆 炸
World Wide Web应用程序的出现（就和邮件应用程序一样），Web作为一个平台，伴随各种程序诞生过。
### 1.7.5 近况


# 2 应用层
## 2.1 应用层协议原理
### 2.1.1 网络应用程序体系结构
- C/S
- P2P
### 2.1.2 进程通讯
1. 客户和服务器进程
2. 进程和网络之间的接口
**套接字**
3. 进程寻址
通过IP地址和Port端口号
### 2.1.3 可供应用程序使用的运输服务
套接字选择协议时，通过需求选择具有恰当服务的运输层协议
服务分为四种：可靠数据传输、吞吐量、定时、安全性
### 2.1.4 运输层协议
具体来说，因特网（或者说TCP/IP网络）提供了TCP和UDP两种运输协议
> 因为两种都没提供安全服务，因此安全套接字层（SSL），诞生咯
> SSL不是与TCP同层次的第三种运输层协议，而是TCP的加强版，在应用层实现，因此在应用程序两端都要有SSL代码（现有的库或类）

### 2.1.5 应用层协议
报文：交换的报文类型，**报文怎么构造，字段什么含义，什么时候发送？**
### 2.1.6 本书涉及的网络应用
## 2.2 Web和HTTP
### 2.2.1 HTTP概况
### 2.2.2 非持续连接和持续连接
### 2.2.3 HTTP报文格式
请求报文和响应报文
### 2.2.4 Cookie
### 2.2.5 Web缓存
缓存服务器能降低平均时延，因为客户和缓存在同一个高速局域网上
CDN越来越重要
### 2.2.6 条件GET方法
不需要更新时不发送对象，仅有因特网时延。
## 2.3 因特网中的电子邮件
### 2.3.1 SMTP
### 2.3.2 与HTTP对比
- 拉协议和推协议
- SMTP必须使用7比特ASCII
- 如何处理多媒体文档
### 2.3.3 邮件报文格式
### 2.3.4 邮件访问协议

## 2.5 P2P文件分发
1. P2P体系结构的拓展性

## 2.6 视频流
### 2.6.1 什么是视频流
### 2.6.2 内容分发网（CDN）

## 2.7 套接字编程
